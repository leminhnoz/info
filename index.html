<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<title>Hello world !</title>
<style>
body{
  margin:0;
  padding:0;
  height:100vh;
  overflow:hidden;
  background:#0f1724;
  color:#e6eef8;
  font-family:sans-serif;
  cursor:none;
  display:flex;
  flex-direction:column;
  align-items:center;
  justify-content:center;
}
#textContainer{
  position:relative;
  z-index:10;
  display:flex;
  flex-direction:column;
  align-items:center;
}
.line{
  font-size:24px;
  margin:5px 0;
  white-space:pre;
  opacity:0;
  transition: opacity 1s;
}
canvas{
  position:absolute;
  top:0; left:0;
}
</style>
</head>
<body>
<canvas id="canvas"></canvas>
<div id="textContainer">
  <div class="line" id="line1"></div>
  <div class="line" id="line2"></div>
</div>

<audio id="keySound" src="https://www.soundjay.com/button/sounds/button-16.mp3"></audio>

<script>
const canvas=document.getElementById('canvas');
const ctx=canvas.getContext('2d');
let cw, ch;
function resize(){ cw=canvas.width=window.innerWidth; ch=canvas.height=window.innerHeight; }
window.addEventListener('resize',resize);
resize();

// --- Cursor trail ---
const cursor={x:cw/2,y:ch/2};
const trailCount=20;
const trails=[];
for(let i=0;i<trailCount;i++) trails.push({x:cursor.x,y:cursor.y});

// --- Rain letters ---
const rainLetters=[];
function spawnLetter(){
  const l={
    x: Math.random()*cw,
    y: -20,
    speed: 1+Math.random()*3,
    char: String.fromCharCode(33+Math.floor(Math.random()*94)),
    fontSize: 10+Math.random()*20,
    opacity: 0.4+Math.random()*0.4
  };
  rainLetters.push(l);
}
setInterval(spawnLetter,50);

// --- Text typewriter ---
const line1=document.getElementById('line1');
const line2=document.getElementById('line2');
const keySound=document.getElementById('keySound');
const text1="Hi ! My full name is Nguyen Duc Le Minh in Vietnamese";
const text2Prefix="My age: ";
const TYPE_SPEED=50;

function playKey(){ keySound.currentTime=0; keySound.play().catch(()=>{}); }

async function typeText(element,text){
  element.style.opacity=1;
  for(let i=0;i<=text.length;i++){
    element.textContent=text.slice(0,i);
    playKey();
    await new Promise(r=>setTimeout(r,TYPE_SPEED));
  }
}

async function deleteText(element){
  for(let i=element.textContent.length;i>=0;i--){
    element.textContent=element.textContent.slice(0,i);
    await new Promise(r=>setTimeout(r,TYPE_SPEED/2));
  }
}

// --- Age counter ---
const origin=new Date(2011,1,2,0,0,0,0);
function pad(n,len=2){return String(n).padStart(len,'0');}
function computeAgeComponents(start, now){
  let years=0, months=0;
  let cursorDate=new Date(start);
  while(new Date(cursorDate.getFullYear()+1,cursorDate.getMonth(),cursorDate.getDate())<=now){
    cursorDate.setFullYear(cursorDate.getFullYear()+1); years++;
  }
  while(new Date(cursorDate.getFullYear(),cursorDate.getMonth()+1,cursorDate.getDate())<=now){
    cursorDate.setMonth(cursorDate.getMonth()+1); months++;
  }
  let remaining=now-cursorDate;
  const ms=remaining%1000;
  remaining=Math.floor(remaining/1000);
  const seconds=remaining%60;
  remaining=Math.floor(remaining/60);
  const minutes=remaining%60;
  remaining=Math.floor(remaining/60);
  const hours=remaining%24;
  const days=Math.floor((now-new Date(cursorDate.getFullYear(),cursorDate.getMonth(),cursorDate.getDate()))/(24*3600*1000));
  return {years,months,days,hours,minutes,seconds,ms};
}

function formatAge(){
  const now=new Date();
  const c=computeAgeComponents(origin,now);
  return `${c.years}y ${c.months}m ${c.days}d ${c.hours}:${pad(c.minutes)}:${pad(c.seconds)}.${String(c.ms).padStart(3,'0')}`;
}

// --- Cursor movement ---
document.addEventListener('mousemove',e=>{
  cursor.x=e.clientX;
  cursor.y=e.clientY;
});

// --- Animation loop ---
function animate(){
  ctx.clearRect(0,0,cw,ch);

  // Rain letters
  for(let i=rainLetters.length-1;i>=0;i--){
    const l=rainLetters[i];
    l.y+=l.speed;
    ctx.globalAlpha=l.opacity;
    ctx.font=`${l.fontSize}px monospace`;
    ctx.fillStyle="#60a5fa";
    ctx.fillText(l.char,l.x,l.y);
    if(l.y>ch) rainLetters.splice(i,1);
  }
  ctx.globalAlpha=1;

  // Cursor trail
  for(let i=trails.length-1;i>=0;i--){
    const t=trails[i];
    t.x += (i===0?cursor.x:trails[i-1].x-t.x)*0.2;
    t.y += (i===0?cursor.y:trails[i-1].y-t.y)*0.2;
    ctx.fillStyle=`rgba(96,165,250,${(trailCount-i)/trailCount})`;
    ctx.beginPath();
    ctx.arc(t.x,t.y,5,0,Math.PI*2);
    ctx.fill();
  }

  // Cursor {}
  ctx.fillStyle="#60a5fa";
  ctx.font="24px monospace";
  ctx.fillText("{}",cursor.x-8,cursor.y+8);

  requestAnimationFrame(animate);
}
animate();

// --- Loop typewriter ---
async function loop(){
  while(true){
    await typeText(line1,text1);
    await typeText(line2,text2Prefix+formatAge());
    await new Promise(r=>setTimeout(r,5000));
    await deleteText(line1);
    await deleteText(line2);
    await new Promise(r=>setTimeout(r,1000));
  }
}
loop();

// --- Update age every frame ---
setInterval(()=>{line2.textContent=text2Prefix+formatAge();},50);
</script>
</body>
</html>
